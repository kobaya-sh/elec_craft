#include <avr/io.h>

/*
  0100010000000101000000000000000000000000000000100000101000000000
  0100010000000101000000000000000000000000000000100000101000000000
  0100010000000101000000000000000000000000000000100000101000000000
  0111110011100101001110000000101010011100101100100111101000000000
  0100010100010101010001000000101010100010110010101000101000000000
  0100010111100101010001000000101010100010100000101000101000000000
  0100010100000101010001001000101010100010100000101000100000000000
  0100010011110101001110010000010100011100100000100111101000000000
*/

static int helloworld[8][8] = {
  { 0x44, 0x05, 0x00, 0x00, 0x00, 0x02, 0x0a, 0x00 }, 
  { 0x44, 0x05, 0x00, 0x00, 0x00, 0x02, 0x0a, 0x00 }, 
  { 0x44, 0x05, 0x00, 0x00, 0x00, 0x02, 0x0a, 0x00 }, 
  { 0x7c, 0xe5, 0x38, 0x0a, 0x9c, 0xb2, 0x7a, 0x00 }, 
  { 0x45, 0x15, 0x44, 0x0a, 0xa2, 0xca, 0x8a, 0x00 }, 
  { 0x45, 0xe5, 0x44, 0x0a, 0xa2, 0x82, 0x8a, 0x00 }, 
  { 0x45, 0x05, 0x44, 0x8a, 0xa2, 0x82, 0x88, 0x00 }, 
  { 0x44, 0xf5, 0x39, 0x05, 0x1c, 0x82, 0x7a, 0x00 }
};

int main(void) {
  volatile unsigned int i, j, k, l, m;
  PORTB = 0xff;
  PORTC = 0xff;
  PORTD = 0xff;
  DDRB = 0xff;
  DDRD = 0xff;
  for (i = 0;; i = (i + 1) & 7) {      // column
    for (m = 0; m < 8; m++){     // bit
      for (j = 0; j < 32; j++) {   // reflesh
        for (k = 0; k < 8; k++) {   // row
          PORTB = 0xff; // clear led
          PORTD = (1 << k); // col[0..7]
          PORTB = ~( (helloworld[k][(i+0)&7] << m)
                   | (helloworld[k][(i+1)&7] >> (8 - m)) );
          for (l = 0; l < 16; l++);
        }
      }
    }
  }
}
